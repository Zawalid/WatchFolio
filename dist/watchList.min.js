"use strict";import{downloadList as e,downloadWatchListContainer as a}from"/download.min.js";import{closeList as t,toggleList as s,displayShow as l,displayList as o,removeFromList as c,clearList as i,sortList as r,searchList as n,showSearchInput as d,hideSearchInput as h,retrieveFromLocalStorageOrDatabase as w,storeInLocalStorageOrDatabase as u,updateLocalStorageOrDatabase as m}from"/utilities.min.js";const L=document.getElementById("watchList"),y=document.querySelectorAll("#watchListButtons button"),g=L.querySelector("#actions");let v=[...L.querySelectorAll("a")];const f={watched:{name:"watched",defaultButton:"I Watched",activeButton:'<i class="fa-solid fa-circle-check"></i> Watched',shows:new Set},watching:{name:"watching",defaultButton:"I'm Watching",activeButton:'<i class="fa-solid fa-eye"></i> Watching',shows:new Set},willWatch:{name:"willWatch",defaultButton:"I Will Watch",activeButton:'<i class="fa-solid fa-calendar-plus"></i> Will Watch',shows:new Set}};for(let a in f)w("watchList",a=f[a]).then(t=>{const e=setInterval(()=>{t.shows.forEach(t=>{t===window.location.search.split("=")[1]&&document.querySelector(`#overview [data-list=${a.name}]`)&&(document.querySelector("#overview [data-favorite=shows]"),document.querySelector(`#overview [data-list=${a.name}]`).innerHTML=a.activeButton,clearInterval(e))})})});u("watchList",["watched","watching","willWatch"]);const p=(e,t)=>{[f.watched.shows,f.watching.shows,f.willWatch.shows].forEach(t=>t.has(e)&&t.delete(e)),[f.watched,f.watching,f.willWatch].forEach(t=>document.querySelector(`[data-list="${t.name}"]`).innerHTML=t.defaultButton),t.shows.add(e),m("watchList",[f.watched,f.watching,f.willWatch])},S=(t,e)=>{e.shows.delete(t),m("watchList",[f.watched,f.watching,f.willWatch])},W=async t=>{y.forEach(t=>t.classList.remove("active")),L.querySelector(`button[data-list='${t}'`).classList.add("active");t=f[t].shows,0===t.size?[...g.querySelectorAll("i")].slice(1).forEach(t=>{t.classList.replace("text-textColor2","text-[darkslategray]"),t.classList.replace("cursor-pointer","cursor-not-allowed")}):[...g.querySelectorAll("i")].slice(1).forEach(t=>{t.classList.replace("text-[darkslategray]","text-textColor2"),t.classList.replace("cursor-not-allowed","cursor-pointer")}),t=0<t.size?(await Promise.all([...t].map(t=>l(t,L)))).join(""):`
  <div class="flex flex-col items-center h-full justify-center ">
  <img src="imgs/undraw_no_data_re_kwbl.svg" alt="" class="w-[120px] mb-5">
  <h2 class="font-bold text-textColor2 text-lg">List is empty</div>
  </div>
  `;L.querySelector("#shows").innerHTML=t,v=[...L.querySelectorAll("a")]},q=(c("removeFromWatchList",L,"list",f,W,S),o(y,L,"list",W),s("watchList_toggler",L,g,W),t("watchList_toggler",L,g,W),g.querySelector("#download").addEventListener("click",t=>{window.matchMedia("(min-width: 768px)").matches&&document.body.classList.add("h-screen","overflow-hidden")||window.scrollTo(0,0),document.getElementById("listName").innerHTML=f[L.dataset.current_list].name,0===f[L.dataset.current_list].shows.size&&document.getElementById("emptyListWarning").classList.replace("hidden","flex"),a.classList.add("show"),setTimeout(()=>{document.getElementById("emptyListWarning").classList.replace("flex","hidden")},3e3)}),a.addEventListener("click",function(t){(t.target.closest("#close")||t.target===t.currentTarget||t.target.closest("ul"))&&(this.classList.remove("show"),window.matchMedia("(min-width: 768px)").matches&&window.location.pathname.includes("show")?document.body.classList.remove("h-screen","overflow-hidden"):document.body.classList.remove("overflow-hidden"),document.getElementById("downloadAllContainer").classList.add("translate-y-full")),t.target.closest("#download")&&e([...this.querySelectorAll("input")].find(t=>t.checked).value,f[L.dataset.current_list]),t.target.closest("#downloadAll")&&e([...this.querySelectorAll("input")].find(t=>t.checked).value,"all")}),i(L,f,"list",W),r(L),L.querySelector("input"));g.querySelector("#search").addEventListener("click",()=>{d(L,q,f,"list")}),q.addEventListener("keyup",t=>{"Enter"===t.key&&(n(q,L,v),h(q))});export{f as watchLists,p as addToWatchList,S as removeFromWatchList};