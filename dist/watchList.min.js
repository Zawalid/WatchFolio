"use strict";import{downloadList,downloadWatchListContainer}from"/download.min.js";import{closeList,toggleList,displayShow,displayList,removeFromList,clearList,sortList,searchList,showSearchInput,hideSearchInput,retrieveFromLocalStorageOrDatabase,storeInLocalStorageOrDatabase,updateLocalStorageOrDatabase}from"/utilities.min.js";const watchListContainer=document.getElementById("watchList"),watchListButtons=document.querySelectorAll("#watchListButtons button"),actions=watchListContainer.querySelector("#actions");let currentListShows=[...watchListContainer.querySelectorAll("a")];const watchLists={watched:{name:"watched",defaultButton:"I Watched",activeButton:'<i class="fa-solid fa-circle-check"></i> Watched',shows:new Set},watching:{name:"watching",defaultButton:"I'm Watching",activeButton:'<i class="fa-solid fa-eye"></i> Watching',shows:new Set},willWatch:{name:"willWatch",defaultButton:"I Will Watch",activeButton:'<i class="fa-solid fa-calendar-plus"></i> Will Watch',shows:new Set}};for(let a in watchLists)retrieveFromLocalStorageOrDatabase("watchList",a=watchLists[a]).then(t=>{const e=setInterval(()=>{t.shows.forEach(t=>{t===window.location.search.split("=")[1]&&document.querySelector(`#overview [data-list=${a.name}]`)&&(document.querySelector("#overview [data-favorite=shows]"),document.querySelector(`#overview [data-list=${a.name}]`).innerHTML=a.activeButton,clearInterval(e))})})});storeInLocalStorageOrDatabase("watchList",["watched","watching","willWatch"]);const addToWatchList=(e,t)=>{[watchLists.watched.shows,watchLists.watching.shows,watchLists.willWatch.shows].forEach(t=>t.has(e)&&t.delete(e)),[watchLists.watched,watchLists.watching,watchLists.willWatch].forEach(t=>document.querySelector(`[data-list="${t.name}"]`).innerHTML=t.defaultButton),t.shows.add(e),updateLocalStorageOrDatabase("watchList",[watchLists.watched,watchLists.watching,watchLists.willWatch])},removeFromWatchList=(t,e)=>{e.shows.delete(t),updateLocalStorageOrDatabase("watchList",[watchLists.watched,watchLists.watching,watchLists.willWatch])},displayShowsFromWatchList=async t=>{watchListButtons.forEach(t=>t.classList.remove("active")),watchListContainer.querySelector(`button[data-list='${t}'`).classList.add("active");t=watchLists[t].shows,t.size<=1?[...actions.querySelectorAll("i")].slice(1).forEach(t=>{t.classList.replace("text-textColor2","text-[darkslategray]"),t.classList.replace("cursor-pointer","cursor-not-allowed")}):[...actions.querySelectorAll("i")].slice(1).forEach(t=>{t.classList.replace("text-[darkslategray]","text-textColor2"),t.classList.replace("cursor-not-allowed","cursor-pointer")}),0<t.size&&(actions.querySelector("#clear").classList.replace("cursor-not-allowed","cursor-pointer"),actions.querySelector("#clear").classList.replace("text-[darkslategray]","text-textColor2")),t=0<t.size?(await Promise.all([...t].map(t=>displayShow(t,watchListContainer)))).join(""):`
  <div class="flex flex-col items-center h-full justify-center ">
  <img src="/imgs/undraw_no_data_re_kwbl.svg" alt="" class="w-[120px] mb-5">
  <h2 class="font-bold text-textColor2 text-lg">List is empty</div>
  </div>
  `;watchListContainer.querySelector("#shows").innerHTML=t,currentListShows=[...watchListContainer.querySelectorAll("a")]},searchListInput=(removeFromList("removeFromWatchList",watchListContainer,"list",watchLists,displayShowsFromWatchList,removeFromWatchList),displayList(watchListButtons,watchListContainer,"list",displayShowsFromWatchList),toggleList("watchList_toggler",watchListContainer,actions,displayShowsFromWatchList),closeList("watchList_toggler",watchListContainer,actions,displayShowsFromWatchList),actions.querySelector("#download").addEventListener("click",t=>{window.matchMedia("(min-width: 768px)").matches&&document.body.classList.add("h-screen","overflow-hidden")||window.scrollTo(0,0),document.getElementById("listName").innerHTML=watchLists[watchListContainer.dataset.current_list].name,0===watchLists[watchListContainer.dataset.current_list].shows.size&&document.getElementById("emptyListWarning").classList.replace("hidden","flex"),downloadWatchListContainer.classList.add("show"),setTimeout(()=>{document.getElementById("emptyListWarning").classList.replace("flex","hidden")},3e3)}),downloadWatchListContainer.addEventListener("click",function(t){(t.target.closest("#close")||t.target===t.currentTarget||t.target.closest("ul"))&&(this.classList.remove("show"),window.matchMedia("(min-width: 768px)").matches&&window.location.pathname.includes("show")?document.body.classList.remove("h-screen","overflow-hidden"):document.body.classList.remove("overflow-hidden"),document.getElementById("downloadAllContainer").classList.add("translate-y-full")),t.target.closest("#download")&&downloadList([...this.querySelectorAll("input")].find(t=>t.checked).value,watchLists[watchListContainer.dataset.current_list]),t.target.closest("#downloadAll")&&downloadList([...this.querySelectorAll("input")].find(t=>t.checked).value,"all")}),clearList(watchListContainer,watchLists,"list",displayShowsFromWatchList),sortList(watchListContainer),watchListContainer.querySelector("input"));actions.querySelector("#search").addEventListener("click",()=>{showSearchInput(watchListContainer,searchListInput,watchLists,"list")}),searchListInput.addEventListener("keyup",t=>{"Enter"===t.key&&(searchList(searchListInput,watchListContainer,currentListShows),hideSearchInput(searchListInput))});export{watchLists,addToWatchList,removeFromWatchList};