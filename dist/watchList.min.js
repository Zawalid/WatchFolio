"use strict";import{downloadList as e,downloadWatchListContainer as a}from"/download.min.js";import{closeList as t,toggleList as s,displayShow as l,displayList as c,removeFromList as o,clearList as i,sortList as r,searchList as n,showSearchInput as d,hideSearchInput as h,retrieveFromLocalStorageOrDatabase as w,storeInLocalStorageOrDatabase as u,updateLocalStorageOrDatabase as m}from"/utilities.min.js";const L=document.getElementById("watchList"),g=document.querySelectorAll("#watchListButtons button"),y=L.querySelector("#actions");let f=[...L.querySelectorAll("a")];const p={watched:{name:"watched",defaultButton:"I Watched",activeButton:'<i class="fa-solid fa-circle-check"></i> Watched',shows:new Set},watching:{name:"watching",defaultButton:"I'm Watching",activeButton:'<i class="fa-solid fa-eye"></i> Watching',shows:new Set},willWatch:{name:"willWatch",defaultButton:"I Will Watch",activeButton:'<i class="fa-solid fa-calendar-plus"></i> Will Watch',shows:new Set}};for(let e in p)w("watchList",e=p[e]).then(t=>{t.shows.forEach(t=>{t===window.location.search.split("=")[1]&&(document.querySelector(`#overview [data-list=${e.name}]`).innerHTML=e.activeButton)})});u("watchList",["watched","watching","willWatch"]);const v=(e,t)=>{[p.watched.shows,p.watching.shows,p.willWatch.shows].forEach(t=>t.has(e)&&t.delete(e)),[p.watched,p.watching,p.willWatch].forEach(t=>document.querySelector(`[data-list="${t.name}"]`).innerHTML=t.defaultButton),t.shows.add(e),m("watchList",[p.watched,p.watching,p.willWatch])},S=(t,e)=>{e.shows.delete(t),m("watchList",[p.watched,p.watching,p.willWatch])},W=async t=>{g.forEach(t=>t.classList.remove("active")),L.querySelector(`button[data-list='${t}'`).classList.add("active");t=p[t].shows,0===t.size?[...y.querySelectorAll("i")].slice(1).forEach(t=>{t.classList.replace("text-textColor2","text-[darkslategray]"),t.classList.replace("cursor-pointer","cursor-not-allowed")}):[...y.querySelectorAll("i")].slice(1).forEach(t=>{t.classList.replace("text-[darkslategray]","text-textColor2"),t.classList.replace("cursor-not-allowed","cursor-pointer")}),t=0<t.size?(await Promise.all([...t].map(t=>l(t,L)))).join(""):`
  <div class="flex flex-col items-center h-full justify-center ">
  <img src="imgs/undraw_no_data_re_kwbl.svg" alt="" class="w-[120px] mb-5">
  <h2 class="font-bold text-textColor2 text-lg">List is empty</div>
  </div>
  `;L.querySelector("#shows").innerHTML=t,f=[...L.querySelectorAll("a")]},x=(o("removeFromWatchList",L,"list",p,W,S),c(g,L,"list",W),s("watchList_toggler",L,y,W),t("watchList_toggler",L,y,W),y.querySelector("#download").addEventListener("click",t=>{window.matchMedia("(min-width: 768px)").matches&&document.body.classList.add("h-screen","overflow-hidden")||window.scrollTo(0,0),document.getElementById("listName").innerHTML=p[L.dataset.current_list].name,0===p[L.dataset.current_list].shows.size&&document.getElementById("emptyListWarning").classList.replace("hidden","flex"),a.classList.add("show"),setTimeout(()=>{document.getElementById("emptyListWarning").classList.replace("flex","hidden")},3e3)}),a.addEventListener("click",function(t){(t.target.closest("#close")||t.target===t.currentTarget||t.target.closest("ul"))&&(this.classList.remove("show"),window.matchMedia("(min-width: 768px)").matches&&window.location.pathname.includes("show.html")?document.body.classList.remove("h-screen","overflow-hidden"):document.body.classList.remove("overflow-hidden"),document.getElementById("downloadAllContainer").classList.add("translate-y-full")),t.target.closest("#download")&&e([...this.querySelectorAll("input")].find(t=>t.checked).value,p[L.dataset.current_list]),t.target.closest("#downloadAll")&&e([...this.querySelectorAll("input")].find(t=>t.checked).value,"all")}),i(L,p,"list",W),r(L),L.querySelector("input"));y.querySelector("#search").addEventListener("click",()=>{d(L,x,p,"list")}),x.addEventListener("keyup",t=>{"Enter"===t.key&&(n(x,L,f),h(L,x))});export{p as watchLists,v as addToWatchList,S as removeFromWatchList};